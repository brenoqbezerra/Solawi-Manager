import { useState, useEffect } from 'react';
import { Language } from './types';

const translations = {
  de: {
    // Existing Dashboard Keys
    dashboard: "Übersicht",
    crops: "Kulturen",
    newCrop: "Neue Kultur",
    settings: "Einstellungen",
    activeCrops: "Aktive Kulturen",
    plannedHarvests: "Geplante Ernten",
    weather: "Wetter",
    culture: "Kultur",
    variety: "Sorte",
    plantWeek: "Pflanzwoche (KW)",
    plantYear: "Pflanzjahr",
    harvestWeek: "Erntewoche (KW)",
    harvestYear: "Erntejahr",
    location: "Standort",
    expectedYield: "Erw. Menge",
    status: "Status",
    actions: "Aktionen",
    save: "Speichern",
    cancel: "Abbrechen",
    harvest: "Ernten",
    edit: "Bearbeiten",
    delete: "Löschen",
    loading: "Laden...",
    noCrops: "Keine Kulturen gefunden. Starten Sie jetzt!",
    harvestDue: "Diese Woche fällig",
    harvestOverdue: "Überfällig",
    harvestSoon: "Bald fällig",
    harvested: "Geerntet",
    growing: "Aktiv",
    unit: "Einheit",
    field: "Feld",
    greenhouse: "Gewächshaus",
    tunnel: "Folientunnel",
    week: "Woche",
    today: "Heute",
    totalHarvest: "Gesamternte",
    cropsStarted: "Kulturen gestartet",
    welcome: "Willkommen zurück",
    weatherError: "Wetterdaten nicht verfügbar",
    resetData: "Alle Daten löschen",
    resetConfirm: "Sind Sie sicher? Alle Daten gehen verloren.",
    deleteConfirm: "Möchten Sie diese Kultur wirklich löschen?",
    inProgress: "Aktiv Gesamt",
    dateRange: "Zeitraum",
    quantity: "Menge",
    harvestActionTitle: "Ernte erfassen",
    harvestActionDesc: "Wie viel wurde geerntet?",
    harvestPartial: "Teilernte (Kultur bleibt aktiv)",
    harvestFull: "Volle Ernte (Abschließen)",
    amountHarvested: "Geerntete Menge",
    remainingAmount: "Verbleibende Menge",
    confirm: "Bestätigen",
    plantDate: "Pflanzdatum",
    harvestDate: "Erntedatum",
    unit_kg: "kg",
    unit_units: "Stück",
    unit_bund: "Bund",
    locationPlaceholder: "z.B. Feld 1, Gewächshaus...",
    culturePlaceholder: "z.B. Karotten, Salat...",
    varietyPlaceholder: "z.B. Nantaise...",
    notes: "Notizen",
    notesPlaceholder: "Optionale Notizen hier...",
    year: "Jahr",
    editCrop: "Kultur bearbeiten",
    planned: "Geplant",
    realized: "Realisiert",
    chartTitle: "Ernteübersicht: Geplant vs. Realisiert",
    saveConfirm: "Änderungen speichern?",
    harvestThisWeek: "Ernte diese Woche",
    plantMonth: "Pflanzmonat",
    harvestMonth: "Erntemonat",
    developedBy: "Entwickelt von",
    backToLanding: "Startseite",

    // Mock Data Keys
    mock_pumpkin: "Kürbis",
    mock_lettuce: "Salat",

    // Landing Page Keys
    lp_hero_title: "Einfache Anbauplanung für Solidarische Landwirtschaft",
    lp_hero_subtitle: "Kostenloses, mehrsprachiges Werkzeug für Landwirte in Genossenschaften und kleinen Betrieben.",
    lp_cta_start: "System testen",
    lp_cta_github: "Quellcode ansehen",
    lp_story_title: "Entstanden aus Beobachtung, Neugier und dem Wunsch zu helfen",
    lp_story_wandel: "Am Rande von Dresden, Deutschland, während meiner Freiwilligenarbeit, kam die Frage auf: Wie kann Technologie bei der Kontrolle und Planung des Anbaus helfen?",
    lp_story_wirgarten: "Bei der Recherche über Genossenschaften in Deutschland stieß ich auf das beeindruckende Projekt WirGarten. Inspiriert davon habe ich eine von ihnen erstellte und frei verfügbare Anbauplanung digitalisiert.",
    lp_story_mvp: "Dies ist ein experimentelles Projekt, einfach und wahrscheinlich mit Mängeln. Aber es kann nützlich sein und ist bereit, mit Ihrer Hilfe zu wachsen.",
    lp_global_reach: "Verfügbar in Deutsch, Englisch, Spanisch, Französisch und Portugiesisch.",
    
    // New Features List
    lp_feat_dashboard: "Sehen Sie auf einen Blick: was gepflanzt ist und was bald geerntet wird",
    lp_feat_harvest: "Ernten erfassen — mit Menge, Datum, Ort und Notizen",
    lp_feat_kw: "Erfassen: wann gepflanzt und wann fertig — nach Wochen, nicht Monaten",
    lp_feat_weather: "Wettervorhersage für die nächsten 7 Tage — direkt für Ihren Standort",
    lp_feat_responsive: "Funktioniert auf jedem Handy — nutzen Sie es direkt auf dem Feld",
    lp_feat_lang: "Deutsch, Englisch, Spanisch, Französisch, Portugiesisch — denn gutes Wissen will geteilt werden",
    
    lp_footer_links: "Inspiration:",
    lp_start_now: "Das System kennenlernen"
  },
  en: {
    // Existing Dashboard Keys
    dashboard: "Dashboard",
    crops: "Crops",
    newCrop: "New Crop",
    settings: "Settings",
    activeCrops: "Active Crops",
    plannedHarvests: "Planned Harvests",
    weather: "Weather",
    culture: "Crop",
    variety: "Variety",
    plantWeek: "Plant Week",
    plantYear: "Plant Year",
    harvestWeek: "Harvest Week",
    harvestYear: "Harvest Year",
    location: "Location",
    expectedYield: "Exp. Yield",
    status: "Status",
    actions: "Actions",
    save: "Save",
    cancel: "Cancel",
    harvest: "Harvest",
    edit: "Edit",
    delete: "Delete",
    loading: "Loading...",
    noCrops: "No crops found. Start planting!",
    harvestDue: "Due This Week",
    harvestOverdue: "Overdue",
    harvestSoon: "Coming Soon",
    harvested: "Harvested",
    growing: "Active",
    unit: "Unit",
    field: "Field",
    greenhouse: "Greenhouse",
    tunnel: "Polytunnel",
    week: "Week",
    today: "Today",
    totalHarvest: "Total Harvest",
    cropsStarted: "Crops Started",
    welcome: "Welcome back",
    weatherError: "Weather data unavailable",
    resetData: "Reset All Data",
    resetConfirm: "Are you sure? All data will be lost.",
    deleteConfirm: "Are you sure you want to delete this crop?",
    inProgress: "Active Total",
    dateRange: "Date Range",
    quantity: "Quantity",
    harvestActionTitle: "Record Harvest",
    harvestActionDesc: "How much was harvested?",
    harvestPartial: "Partial Harvest (Keep Active)",
    harvestFull: "Full Harvest (Complete)",
    amountHarvested: "Amount Harvested",
    remainingAmount: "Remaining Expected",
    confirm: "Confirm",
    plantDate: "Planting Date",
    harvestDate: "Harvest Date",
    unit_kg: "kg",
    unit_units: "units",
    unit_bund: "bundles",
    locationPlaceholder: "e.g. Field 1, Greenhouse...",
    culturePlaceholder: "e.g. Carrots, Lettuce...",
    varietyPlaceholder: "e.g. Nantaise...",
    notes: "Notes",
    notesPlaceholder: "Optional notes here...",
    year: "Year",
    editCrop: "Edit Crop",
    planned: "Planned",
    realized: "Realized",
    chartTitle: "Harvest Overview: Planned vs Realized",
    saveConfirm: "Save changes?",
    harvestThisWeek: "Harvest This Week",
    plantMonth: "Plant Month",
    harvestMonth: "Harvest Month",
    developedBy: "Developed by",
    backToLanding: "Home Page",

    // Mock Data Keys
    mock_pumpkin: "Pumpkin",
    mock_lettuce: "Lettuce",

    // Landing Page Keys
    lp_hero_title: "Simple Crop Planning for Community Supported Agriculture",
    lp_hero_subtitle: "Free, multilingual tool for cooperative farmers and small properties.",
    lp_cta_start: "Try the System",
    lp_cta_github: "View Source",
    lp_story_title: "Created from observation, curiosity, and the desire to help",
    lp_story_wandel: "On the outskirts of Dresden, Germany, during my volunteer work, the question arose: How can technology help with crop control and planning?",
    lp_story_wirgarten: "Researching cooperatives in Germany, I found an amazing project called WirGarten and was inspired to digitize a crop planning tool created by them and made available for free.",
    lp_story_mvp: "This is an experimental project, simple and likely with defects. But it can be useful and is ready to grow with your help.",
    lp_global_reach: "Available in German, English, Spanish, French, and Portuguese.",
    
    // New Features List
    lp_feat_dashboard: "See at a glance: what is planted and what will be harvested soon",
    lp_feat_harvest: "Record harvests — with quantity, date, location and notes",
    lp_feat_kw: "Record: when planted and when ready — by weeks, not months",
    lp_feat_weather: "Weather forecast for the next 7 days — straight to your location",
    lp_feat_responsive: "Works on any phone — use it directly in the field, Android or iPhone",
    lp_feat_lang: "German, English, Spanish, French, Portuguese — because good knowledge wants to be shared",

    lp_footer_links: "Inspiration:",
    lp_start_now: "Explore the System"
  },
  es: {
    // Existing Dashboard Keys
    dashboard: "Panel",
    crops: "Cultivos",
    newCrop: "Nuevo Cultivo",
    settings: "Configuración",
    activeCrops: "Cultivos Activos",
    plannedHarvests: "Cosechas Planificadas",
    weather: "Clima",
    culture: "Cultivo",
    variety: "Variedad",
    plantWeek: "Sem. Siembra",
    plantYear: "Año Siembra",
    harvestWeek: "Sem. Cosecha",
    harvestYear: "Año Cosecha",
    location: "Ubicación",
    expectedYield: "Ctd. Esperada",
    status: "Estado",
    actions: "Acciones",
    save: "Guardar",
    cancel: "Cancelar",
    harvest: "Cosechar",
    edit: "Editar",
    delete: "Eliminar",
    loading: "Cargando...",
    noCrops: "No se encontraron cultivos.",
    harvestDue: "Para esta semana",
    harvestOverdue: "Atrasado",
    harvestSoon: "Próximamente",
    harvested: "Cosechado",
    growing: "Activo",
    unit: "Unidad",
    field: "Campo",
    greenhouse: "Invernadero",
    tunnel: "Túnel",
    week: "Semana",
    today: "Hoy",
    totalHarvest: "Cosecha Total",
    cropsStarted: "Cultivos Iniciados",
    welcome: "Bienvenido",
    weatherError: "Clima no disponible",
    resetData: "Restablecer Datos",
    resetConfirm: "¿Estás seguro? Se perderán todos los datos.",
    deleteConfirm: "¿Seguro que quieres eliminar este cultivo?",
    inProgress: "Total Activos",
    dateRange: "Fechas",
    quantity: "Cantidad",
    harvestActionTitle: "Registrar Cosecha",
    harvestActionDesc: "¿Cuánto se cosechó?",
    harvestPartial: "Parcial (Mantener Activo)",
    harvestFull: "Total (Finalizar)",
    amountHarvested: "Cantidad Cosechada",
    remainingAmount: "Restante Esperado",
    confirm: "Confirmar",
    plantDate: "Fecha de Siembra",
    harvestDate: "Fecha de Cosecha",
    unit_kg: "kg",
    unit_units: "unidades",
    unit_bund: "manojos",
    locationPlaceholder: "ej. Campo 1, Invernadero...",
    culturePlaceholder: "ej. Zanahorias, Lechuga...",
    varietyPlaceholder: "ej. Nantaise...",
    notes: "Notas",
    notesPlaceholder: "Notas opcionales aquí...",
    year: "Año",
    editCrop: "Editar Cultivo",
    planned: "Planificado",
    realized: "Realizado",
    chartTitle: "Resumen: Planificado vs Realizado",
    saveConfirm: "¿Guardar cambios?",
    harvestThisWeek: "Cosecha esta semana",
    plantMonth: "Mes Siembra",
    harvestMonth: "Mes Cosecha",
    developedBy: "Desarrollado por",
    backToLanding: "Inicio",

    // Mock Data Keys
    mock_pumpkin: "Calabaza",
    mock_lettuce: "Lechuga",

    // Landing Page Keys
    lp_hero_title: "Planificación de Cultivos Simple para Agricultura Solidaria",
    lp_hero_subtitle: "Herramienta gratuita y multilingüe para agricultores de cooperativas y pequeñas propiedades.",
    lp_cta_start: "Probar el Sistema",
    lp_cta_github: "Ver Código",
    lp_story_title: "Concebido a partir de la observación, curiosidad y el deseo de ayudar",
    lp_story_wandel: "En las afueras de Dresde, Alemania, durante mi trabajo voluntario, surgió la pregunta: ¿Cómo puede la tecnología ayudar en el control y la planificación del cultivo?",
    lp_story_wirgarten: "Investigando sobre cooperativas en Alemania, encontré un proyecto increíble llamado WirGarten y decidí inspirarme para digitalizar una herramienta de planificación de cultivos creada por ellos y disponible gratuitamente.",
    lp_story_mvp: "Este es un proyecto experimental, simple y probablemente tenga defectos. Pero puede ser útil y está listo para crecer con tu ayuda.",
    lp_global_reach: "Disponible en alemán, inglés, español, francés y portugués.",
    
    // New Features List
    lp_feat_dashboard: "Vea de un vistazo: qué está plantado y qué se cosechará pronto",
    lp_feat_harvest: "Registre cosechas — con cantidad, fecha, ubicación y notas",
    lp_feat_kw: "Registre: cuándo se plantó y cuándo estará listo — por semanas, no meses",
    lp_feat_weather: "Pronóstico del tiempo para los próximos 7 días — directo a su ubicación",
    lp_feat_responsive: "Funciona en cualquier celular — úselo directamente en el campo",
    lp_feat_lang: "Alemán, inglés, español, francés, portugués — porque el buen conocimiento quiere ser compartido",

    lp_footer_links: "Inspiración:",
    lp_start_now: "Conocer el Sistema"
  },
  fr: {
    // Existing Dashboard Keys
    dashboard: "Tableau de bord",
    crops: "Cultures",
    newCrop: "Nouvelle Culture",
    settings: "Paramètres",
    activeCrops: "Cultures Actives",
    plannedHarvests: "Récoltes Prévues",
    weather: "Météo",
    culture: "Culture",
    variety: "Variété",
    plantWeek: "Sem. Plantation",
    plantYear: "Année Plantation",
    harvestWeek: "Sem. Récolte",
    harvestYear: "Année Récolte",
    location: "Emplacement",
    expectedYield: "Rendement Prévu",
    status: "Statut",
    actions: "Actions",
    save: "Enregistrer",
    cancel: "Annuler",
    harvest: "Récolter",
    edit: "Modifier",
    delete: "Supprimer",
    loading: "Chargement...",
    noCrops: "Aucune culture trouvée.",
    harvestDue: "À récolter cette semaine",
    harvestOverdue: "En Retard",
    harvestSoon: "Bientôt",
    harvested: "Récolté",
    growing: "Actif",
    unit: "Unité",
    field: "Champ",
    greenhouse: "Serre",
    tunnel: "Tunnel",
    week: "Semaine",
    today: "Aujourd'hui",
    totalHarvest: "Récolte Totale",
    cropsStarted: "Cultures Lancées",
    welcome: "Bienvenue",
    weatherError: "Météo indisponible",
    resetData: "Réinitialiser",
    resetConfirm: "Êtes-vous sûr ? Toutes les données seront perdues.",
    deleteConfirm: "Voulez-vous vraiment supprimer ?",
    inProgress: "Total Actif",
    dateRange: "Période",
    quantity: "Quantité",
    harvestActionTitle: "Enregistrer la récolte",
    harvestActionDesc: "Combien a été récolté ?",
    harvestPartial: "Partielle (Garder Actif)",
    harvestFull: "Totale (Terminer)",
    amountHarvested: "Quantité Récoltée",
    remainingAmount: "Reste Prévu",
    confirm: "Confirmer",
    plantDate: "Date de Plantation",
    harvestDate: "Date de Récolte",
    unit_kg: "kg",
    unit_units: "pièces",
    unit_bund: "bottes",
    locationPlaceholder: "ex. Champ 1, Serre...",
    culturePlaceholder: "ex. Carottes, Laitue...",
    varietyPlaceholder: "ex. Nantaise...",
    notes: "Notes",
    notesPlaceholder: "Notes optionnelles...",
    year: "Année",
    editCrop: "Modifier Culture",
    planned: "Prévu",
    realized: "Réalisé",
    chartTitle: "Aperçu: Prévu vs Réalisé",
    saveConfirm: "Enregistrer les modifications ?",
    harvestThisWeek: "Récolte cette semaine",
    plantMonth: "Mois Plantation",
    harvestMonth: "Mois Récolte",
    developedBy: "Développé par",
    backToLanding: "Accueil",

    // Mock Data Keys
    mock_pumpkin: "Citrouille",
    mock_lettuce: "Laitue",

    // Landing Page Keys
    lp_hero_title: "Planification des Cultures Simple pour l'Agriculture Solidaire",
    lp_hero_subtitle: "Outil gratuit et multilingue pour les agriculteurs de coopératives et petites propriétés.",
    lp_cta_start: "Tester le Système",
    lp_cta_github: "Voir le Code",
    lp_story_title: "Né de l'observation, de la curiosité et du désir d'aider",
    lp_story_wandel: "Aux abords de Dresde, en Allemagne, lors de mon bénévolat, la question s'est posée : Comment la technologie peut-elle aider au contrôle et à la planification des cultures ?",
    lp_story_wirgarten: "En faisant des recherches sur les coopératives en Allemagne, j'ai découvert un projet incroyable appelé WirGarten et je me suis inspiré pour numériser un outil de planification des cultures créé par eux et mis à disposition gratuitement.",
    lp_story_mvp: "C'est un projet expérimental, simple et susceptible d'avoir des défauts. Mais il peut être utile et est prêt à grandir avec votre aide.",
    lp_global_reach: "Disponible en allemand, anglais, espagnol, français et portugais.",
    
    // New Features List
    lp_feat_dashboard: "Voyez en un coup d'œil : ce qui est planté et ce qui sera bientôt récolté",
    lp_feat_harvest: "Enregistrez les récoltes — avec quantité, date, lieu et notes",
    lp_feat_kw: "Enregistrez : quand c'est planté et quand c'est prêt — par semaines, pas par mois",
    lp_feat_weather: "Prévisions météo pour les 7 prochains jours — directement pour votre localisation",
    lp_feat_responsive: "Fonctionne sur n'importe quel téléphone — utilisez-le directement au champ",
    lp_feat_lang: "Allemand, anglais, espagnol, français, portugais — parce que le bon savoir veut être partagé",

    lp_footer_links: "Inspiration:",
    lp_start_now: "Découvrir le Système"
  },
  pt: {
    // Existing Dashboard Keys
    dashboard: "Painel",
    crops: "Cultivos",
    newCrop: "Novo Cultivo",
    settings: "Configurações",
    activeCrops: "Cultivos Ativos",
    plannedHarvests: "Colheitas Planejadas",
    weather: "Previsão",
    culture: "Cultura",
    variety: "Variedade",
    plantWeek: "Sem. Plantio",
    plantYear: "Ano Plantio",
    harvestWeek: "Sem. Colheita",
    harvestYear: "Ano Colheita",
    location: "Localização",
    expectedYield: "Qtd. Esperada",
    status: "Status",
    actions: "Ações",
    save: "Salvar",
    cancel: "Cancelar",
    harvest: "Colher",
    edit: "Editar",
    delete: "Excluir",
    loading: "Carregando...",
    noCrops: "Nenhum cultivo encontrado.",
    harvestDue: "Colher esta semana",
    harvestOverdue: "Atrasado",
    harvestSoon: "Em Breve",
    harvested: "Colhido",
    growing: "Ativo",
    unit: "Unidade",
    field: "Campo",
    greenhouse: "Estufa",
    tunnel: "Túnel",
    week: "Semana",
    today: "Hoje",
    totalHarvest: "Colheita Total",
    cropsStarted: "Cultivos Iniciados",
    welcome: "Bem-vindo de volta",
    weatherError: "Clima indisponível",
    resetData: "Resetar Dados",
    resetConfirm: "Tem certeza? Todos os dados serão perdidos.",
    deleteConfirm: "Tem certeza que deseja apagar este cultivo?",
    inProgress: "Ativos Totais",
    dateRange: "Período",
    quantity: "Quantidade",
    harvestActionTitle: "Registrar Colheita",
    harvestActionDesc: "Quanto foi colhido?",
    harvestPartial: "Parcial (Manter Ativo)",
    harvestFull: "Total (Finalizar)",
    amountHarvested: "Quantidade Colhida",
    remainingAmount: "Restante Esperado",
    confirm: "Confirmar",
    plantDate: "Data do Plantio",
    harvestDate: "Data da Colheita",
    unit_kg: "kg",
    unit_units: "unidades",
    unit_bund: "maços",
    locationPlaceholder: "ex: Canteiro 1, Estufa A...",
    culturePlaceholder: "ex: Cenoura, Alface...",
    varietyPlaceholder: "ex: Nantaise...",
    notes: "Anotações",
    notesPlaceholder: "Anotações opcionais aqui...",
    year: "Ano",
    editCrop: "Editar Cultivo",
    planned: "Planejado",
    realized: "Realizado",
    chartTitle: "Visão Geral: Planejado x Realizado",
    saveConfirm: "Salvar alterações?",
    harvestThisWeek: "Colheita esta semana",
    plantMonth: "Mês Plantio",
    harvestMonth: "Mês Colheita",
    developedBy: "Desenvolvido por",
    backToLanding: "Página Inicial",

    // Mock Data Keys
    mock_pumpkin: "Abóbora",
    mock_lettuce: "Alface",

    // Landing Page Keys
    lp_hero_title: "Planejamento de Cultivo Simples para Agricultura Solidaria",
    lp_hero_subtitle: "Ferramenta gratuita para agricultores de cooperativas e pequenas propriedades rurais, multilíngue.",
    lp_cta_start: "Testar o Sistema",
    lp_cta_github: "Ver Código",
    lp_story_title: "Concebido a partir da observação, curiosidade e desejo de ajudar",
    lp_story_wandel: "Nos arredores de Dresden, na Alemanha, ao longo do meu trabalho voluntário, surgiu uma pergunta: Como a tecnologia pode ajudar no controle e planejamento do cultivo?",
    lp_story_wirgarten: "Pesquisando sobre o mundo das Cooperativas na Alemanha, encontrei um projeto incrível chamado WirGarten e resolvi me inspirar para digitalizar uma ferramenta de planejamento de cultivo criada por eles e disponibilizada gratuitamente.",
    lp_story_mvp: "Este é um projeto experimental, simples e deve ter vários defeitos. Mas pode ser útil e está pronto para crescer com a sua ajuda.",
    lp_global_reach: "Disponível em Alemão, Inglês, Espanhol, Francês e Português.",
    
    // New Features List
    lp_feat_dashboard: "Veja num só olhar: o que está plantado e o que vai ser colhido em breve",
    lp_feat_harvest: "Registre colheitas — com quantidade, data, local e faça anotações (se quiser)",
    lp_feat_kw: "Registre: quando algo foi plantado e quando ficará pronto — por semanas, não por meses",
    lp_feat_weather: "Previsão do tempo para os próximos 7 dias — direto para sua localização, sem precisar procurar",
    lp_feat_responsive: "Funciona em qualquer celular — use direto no campo, seja Android ou iPhone",
    lp_feat_lang: "Alemão, inglês, espanhol, francês, português — porque conhecimento bom quer ser compartilhado",

    lp_footer_links: "Inspiração:",
    lp_start_now: "Conhecer o Sistema"
  }
};

const listeners = new Set<(lang: Language) => void>();

export const setGlobalLanguage = (lang: Language) => {
  localStorage.setItem('solawi_lang', lang);
  listeners.forEach((l) => l(lang));
};

export const useTranslation = () => {
  const [lang, setLang] = useState<Language>(
    (localStorage.getItem('solawi_lang') as Language) || 'de'
  );

  useEffect(() => {
    const handler = (l: Language) => setLang(l);
    listeners.add(handler);
    return () => {
      listeners.delete(handler);
    };
  }, []);

  const t = (key: keyof typeof translations['de']) => {
    // @ts-ignore
    return translations[lang]?.[key] || translations['en']?.[key] || key;
  };

  return { t, lang, setLang: setGlobalLanguage };
};